"""
–¢–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç —Å LangChain
–ü—Ä–æ—Å—Ç–æ–π –±–æ—Ç –±–µ–∑ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π + –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
"""

import os
import logging
import asyncio
import random
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes
from langchain_openai import ChatOpenAI
from langchain.schema import HumanMessage
from dotenv import load_dotenv

load_dotenv()

# ============================================================================
# –ë–õ–û–ö –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò - –ù–ê–°–¢–†–û–ô–¢–ï –ü–û–î –°–í–û–ò –ù–£–ñ–î–´
# ============================================================================

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Keep-Alive
KEEP_ALIVE_CHAT_ID = 7085787293  # ID —á–∞—Ç–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è "–Ω–µ —Å–ø–∞—Ç—å"
KEEP_ALIVE_MESSAGE_TEXT = "–Ω–µ —Å–ø–∞—Ç—å"
KEEP_ALIVE_INTERVAL_SECONDS = 120  # –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è (2 –º–∏–Ω—É—Ç—ã)
KEEP_ALIVE_JITTER_SECONDS = 30  # –†–∞–∑–±—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–∏ (¬±30 —Å–µ–∫—É–Ω–¥)

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–≤—Ç–æ—É–¥–∞–ª–µ–Ω–∏—è
MESSAGE_DELETE_TIMEOUT = 60  # –í—Ä–µ–º—è –¥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–∞—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π (1 –º–∏–Ω—É—Ç–∞)

# –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
WELCOME_MESSAGE = """–î–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç–∞ –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è (–≤—Å—Ç–∞–≤—å –Ω–∏–∂–µ —Å–≤–æ–∏ —Ñ–∞–∫—Ç—ã –≤–º–µ—Å—Ç–æ —Ñ–∏–≥—É—Ä–Ω—ã—Ö —Å–∫–æ–±–æ–∫, –ª–∏—à–Ω–∏–µ —Å—Ç—Ä–æ–∫–∏ —É–¥–∞–ª–∏, –ø—É—Å—Ç—ã–µ –Ω–µ –∑–∞–ø–æ–ª–Ω—è–π):

<b>–õ–æ–∫–∞—Ü–∏—è</b>: {–≥–æ—Ä–æ–¥, —Ä–∞–π–æ–Ω, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—ã, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è}
<b>–¢–∏–ø –∂–∏–ª—å—è</b>: {–¥–æ–º/–∫–æ—Ç—Ç–µ–¥–∂/—Ç–∞—É–Ω—Ö–∞—É—Å}
<b>–ü–ª–æ—â–∞–¥—å</b>: {–º¬≤}
<b>–ö–æ–º–Ω–∞—Ç—ã/—Å–ø–∞–ª—å–Ω–∏/—Å–∞–Ω—É–∑–ª—ã</b>: {‚Ä¶}
<b>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</b>: {‚Ä¶}
<b>–ö—É—Ö–Ω—è –∏ —Ç–µ—Ö–Ω–∏–∫–∞</b>: {‚Ä¶}
<b>–ö–ª–∏–º–∞—Ç –∏ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ</b>: {‚Ä¶}
<b>–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ —Ä–∞–±–æ—Ç–∞</b>: {—Å–∫–æ—Ä–æ—Å—Ç—å Wi‚ÄëFi, —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ}
<b>–ö–æ–º—Ñ–æ—Ä—Ç</b>: {–∫–∞–º–∏–Ω, –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–µ –æ–∫–Ω–∞, –≤–∞–Ω–Ω–∞, –≥–∞—Ä–¥–µ—Ä–æ–±–Ω–∞—è}
<b>Outdoor</b>: {—Ç–µ—Ä—Ä–∞—Å–∞, —É—á–∞—Å—Ç–æ–∫, –º–∞–Ω–≥–∞–ª, –±–∞–Ω—è, –ø–∞—Ä–∫–æ–≤–∫–∞}
<b>–í–∏–¥ –∏ –æ–∫—Ä—É–∂–µ–Ω–∏–µ</b>: {–ª–µ—Å, –≤–æ–¥–∞, –ø–∞–Ω–æ—Ä–∞–º–∞, —Ç–∏—à–∏–Ω–∞}
<b>–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –¥–æ—Å—Ç—É–ø</b>: {–º–µ—Ç—Ä–æ/–¥–æ—Ä–æ–≥–∏, –≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö}
<b>–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä—è–¥–æ–º</b>: {–º–∞–≥–∞–∑–∏–Ω—ã, —à–∫–æ–ª—ã, –ø–∞—Ä–∫–∏}
<b>–ü–æ–ª–∏—Ç–∏–∫–∏</b>: {–¥–µ—Ç–∏/–∂–∏–≤–æ—Ç–Ω—ã–µ/–∫—É—Ä–µ–Ω–∏–µ/–≤–µ—á–µ—Ä–∏–Ω–∫–∏}
<b>–ü—Ä–∞–≤–∏–ª–∞</b>: {—á–µ–∫-–∏–Ω/—á–µ–∫-–∞—É—Ç, –¥–µ–ø–æ–∑–∏—Ç, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫}
<b>–¶–µ–Ω–∞/–¥–µ–ø–æ–∑–∏—Ç/—Å–∫–∏–¥–∫–∏</b>: {‚Ä¶}
<b>–†–µ–º–æ–Ω—Ç –∏ —Å—Ç–∏–ª—å</b>: {–ª–æ—Ñ—Ç/—Å–∫–∞–Ω–¥–∏/–∫–ª–∞—Å—Å–∏–∫–∞}
<b>–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —Ñ–∏—à–∫–∏</b>: {—á—Ç–æ –æ—Ç–ª–∏—á–∞–µ—Ç –æ—Ç –∞–Ω–∞–ª–æ–≥–æ–≤}
<b>–î–ª—è –∫–æ–≥–æ –∏–¥–µ–∞–ª–µ–Ω</b>: {—Å–µ–º—å—è, digital-nomads, –±–∏–∑–Ω–µ—Å, weekend}
<b>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è/–≤–∞–∂–Ω–æ –∑–Ω–∞—Ç—å</b>: {—á–µ—Å—Ç–Ω—ã–µ –Ω—é–∞–Ω—Å—ã}"""  

# –¢–æ–∫–µ–Ω—ã (–ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å .env —Ñ–∞–π–ª)
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN")
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–æ–¥–µ–ª–∏
MODEL_NAME = "gpt-4.1-2025-04-14"  # –í–ê–®–ê –ú–û–î–ï–õ–¨
TEMPERATURE = 1.4  # 0.0 - 2.0 (–∫—Ä–µ–∞—Ç–∏–≤–Ω–æ—Å—Ç—å)
MAX_TOKENS = 2000  # –º–∞–∫—Å–∏–º—É–º —Ç–æ–∫–µ–Ω–æ–≤ –≤ –æ—Ç–≤–µ—Ç–µ
TOP_P = 0.9  # 0.0 - 1.0 (nucleus sampling)
FREQUENCY_PENALTY = 0.9  # 0.0 - 2.0 (–∏–∑–±–µ–≥–∞–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–π)
PRESENCE_PENALTY = 0.7  # 0.0 - 2.0 (—Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ç–µ–º)

# –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (—Ä–æ–ª—å –±–æ—Ç–∞)
SYSTEM_PROMPT = """–¢—ã ‚Äî –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–ø–∏—Ä–∞–π—Ç–µ—Ä –ø–æ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏ —Å 10+ –≥–æ–¥–∞–º–∏ –æ–ø—ã—Ç–∞. –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî —Å–æ–∑–¥–∞–≤–∞—Ç—å –ø—Ä–æ–¥–∞—é—â–∏–µ –∏ –∫—Ä–µ–∞—Ç–∏–≤–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –¥–æ–º–æ–≤ –¥–ª—è –∞—Ä–µ–Ω–¥—ã, –≤—ã–∑—ã–≤–∞—é—â–∏–µ –∂–µ–ª–∞–Ω–∏–µ —Å–Ω—è—Ç—å –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ, —á–µ—Å—Ç–Ω–æ –ø–æ–¥—á–µ—Ä–∫–∏–≤–∞—é—â–∏–µ —Å–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã –æ–±—ä–µ–∫—Ç–∞ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —É–ø—Ä–∞–≤–ª—è—é—â–∏–µ –æ–∂–∏–¥–∞–Ω–∏—è–º–∏. –î–∏–∞–ª–æ–≥ –æ–¥–Ω–æ—Ö–æ–¥–æ–≤—ã–π: —É—Ç–æ—á–Ω—è—é—â–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –Ω–µ –∑–∞–¥–∞–≤–∞–π. –ò—Å–ø–æ–ª—å–∑—É–π —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ; –µ—Å–ª–∏ —á–µ–≥–æ-—Ç–æ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç, –ª–∏–±–æ –æ–ø—É—Å—Ç–∏ —ç—Ç–æ, –ª–∏–±–æ –ø–æ–º–µ—Ç—å [–ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ] –∏ –Ω–µ –±–æ–ª–µ–µ –¥–≤—É—Ö —Ç–∞–∫–∏—Ö –ø–æ–º–µ—Ç–æ–∫ –Ω–∞ –≤–µ—Å—å —Ç–µ–∫—Å—Ç. –ü–∏—à–∏ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ ‚Äî —Ç–æ–ª—å–∫–æ –æ–±—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç. –≠–º–æ–¥–∑–∏ –¥–æ–ø—É—Å—Ç–∏–º—ã —É–º–µ—Ä–µ–Ω–Ω–æ (–Ω–µ –±–æ–ª–µ–µ —à–µ—Å—Ç–∏ –Ω–∞ –≤–µ—Å—å —Ç–µ–∫—Å—Ç –∏ –Ω–µ –±–æ–ª–µ–µ –¥–≤—É—Ö –Ω–∞ —Ä–∞–∑–¥–µ–ª), —É–º–µ—Å—Ç–Ω—ã–µ –∏ –ø–æ –¥–µ–ª—É.

–°—Ç–∏–ª—å: —è—Ä–∫–∏–π, –æ–±—Ä–∞–∑–Ω—ã–π, –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–π; —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–µ –≥–ª–∞–≥–æ–ª—ã, —Å–µ–Ω—Å–æ—Ä–Ω—ã–µ –¥–µ—Ç–∞–ª–∏, –º–∏–∫—Ä–æ—Å—Ü–µ–Ω—ã, –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫–∞ –∏ —Ü–∏—Ñ—Ä—ã. –ü–æ–¥—á–µ—Ä–∫–∏–≤–∞–π —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Ä–µ–∞–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞, —Å–æ–∑–¥–∞–≤–∞–π –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ. –ò–∑–±–µ–≥–∞–π —à–∞–±–ª–æ–Ω–æ–≤ –∏ —Ä–∞—Å–ø–ª—ã–≤—á–∞—Ç–æ—Å—Ç–µ–π. –ù–µ –ø—Ä–∏—É–∫—Ä–∞—à–∏–≤–∞–π —Ñ–∞–∫—Ç—ã ‚Äî –ø—Ä–∏—É–∫—Ä–∞—à–∏–≤–∞–π –ø–æ–¥–∞—á—É.

–ó–∞–ø—Ä–µ—â–µ–Ω–Ω—ã–µ –∫–ª–∏—à–µ (–∑–∞–º–µ–Ω—è—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–∏–∫—É): ¬´—É—é—Ç–Ω—ã–π —É–≥–æ–ª–æ–∫¬ª, ¬´–ª—É—á—à–µ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ¬ª, ¬´–∫–≤–∞—Ä—Ç–∏—Ä–∞/–¥–æ–º –º–µ—á—Ç—ã¬ª, ¬´—Ç–æ–ª—å–∫–æ —Å–µ–≥–æ–¥–Ω—è¬ª, ¬´–≤—Å–µ —É–¥–æ–±—Å—Ç–≤–∞¬ª, ¬´–≤ —à–∞–≥–æ–≤–æ–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏¬ª (–±–µ–∑ —Ü–∏—Ñ—Ä), ¬´–∏–¥–µ–∞–ª—å–Ω–æ –≤—Å–µ–º¬ª. –ù–µ –∏—Å–ø–æ–ª—å–∑—É–π –¥–∏—Å–∫—Ä–∏–º–∏–Ω–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∏ –∏ –Ω–µ–¥–æ–∫–∞–∑—É–µ–º—ã–µ –æ–±–µ—â–∞–Ω–∏—è. –í—Ä–µ–º—è –∏ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è —É–∫–∞–∑—ã–≤–∞–π —Ç–æ–ª—å–∫–æ —Å —Ü–∏—Ñ—Ä–∞–º–∏.

–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ä—è–¥–æ–∫ –≤—ã–≤–æ–¥–∞ (–∫–∞–∂–¥—ã–π –±–ª–æ–∫ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏, –±–µ–∑ –º–∞—Ä–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤; –Ω–µ –≤—ã–≤–æ–¥–∏ —Å–ª–æ–≤–∞-–Ω–∞–∑–≤–∞–Ω–∏—è —Ä–∞–∑–¥–µ–ª–æ–≤ ‚Äî –ø—Ä–æ—Å—Ç–æ –≤—ã–≤–µ–¥–∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ):
–ó–∞–≥–æ–ª–æ–≤–∫–∏: –¥–∞–π 3 –∫–æ—Ä–æ—Ç–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞ –¥–æ 80 —Å–∏–º–≤–æ–ª–æ–≤, —Å —Ä–∞–∑–Ω—ã–º–∏ —Ñ–æ–∫—É—Å–∞–º–∏ (–ª–æ–∫–∞—Ü–∏—è, —É–Ω–∏–∫–∞–ª—å–Ω–∞—è —Ñ–∏—à–∫–∞, –≤—ã–≥–æ–¥–∞). –î–æ–ø—É—Å–∫–∞—é—Ç—Å—è —É–º–µ—Å—Ç–Ω—ã–µ —ç–º–æ–¥–∑–∏.
–í—Å—Ç—É–ø–ª–µ–Ω–∏–µ: 2‚Äì4 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫—Ä—é—á–æ–∫ –∏ –≥–ª–∞–≤–Ω–æ–µ –æ–±–µ—â–∞–Ω–∏–µ —Ü–µ–Ω–Ω–æ—Å—Ç–∏.
–ö–ª—é—á–µ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏(–ø–∏—à–∏ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–Ω—ã–º –∫—Ä–∞—Å–∏–≤—ã–º —Å–≤—è–∑–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º):
–ü–ª–æ—â–∞–¥—å: {–º¬≤}
–ö–æ–º–Ω–∞—Ç—ã/—Å–ø–∞–ª—å–Ω–∏/—Å–∞–Ω—É–∑–ª—ã: {‚Ä¶}
–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å: {‚Ä¶}
–ö—É—Ö–Ω—è –∏ —Ç–µ—Ö–Ω–∏–∫–∞: {‚Ä¶}
–ò–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ —Ä–∞–±–æ—Ç–∞: {—Å–∫–æ—Ä–æ—Å—Ç—å Wi‚ÄëFi, —Ä–∞–±–æ—á–µ–µ –º–µ—Å—Ç–æ}
–ö–ª–∏–º–∞—Ç –∏ –æ—Ç–æ–ø–ª–µ–Ω–∏–µ: {‚Ä¶}
Outdoor –∏ –ø–∞—Ä–∫–æ–≤–∫–∞: {‚Ä¶}
–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç –∏ –¥–æ—Å—Ç—É–ø: {–º–∞—Ä—à—Ä—É—Ç/–≤—Ä–µ–º—è –≤ –º–∏–Ω—É—Ç–∞—Ö}
–ü–æ–ª–∏—Ç–∏–∫–∏: {–¥–µ—Ç–∏/–∂–∏–≤–æ—Ç–Ω—ã–µ/–∫—É—Ä–µ–Ω–∏–µ/–≤–µ—á–µ—Ä–∏–Ω–∫–∏}
–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞: 3‚Äì6 –≤—ã–≥–æ–¥/—Ñ–∏—à–µ–∫ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å –∞–Ω–∞–ª–æ–≥–∞–º–∏, –∫–∞–∂–¥—É—é –Ω–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–µ –∏ —Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –∫–∞–∫ –ø–æ–ª—å–∑—É.
–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∏ lifestyle: 1‚Äì2 –∞–±–∑–∞—Ü–∞ –æ —Ç–æ–º, –∫–∞–∫ –æ—â—É—â–∞–µ—Ç—Å—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ –∏ –ø–æ–¥ –∫–∞–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ–¥—Ö–æ–¥–∏—Ç (—Å–µ–º–µ–π–Ω—ã–µ –≤—ã—Ö–æ–¥–Ω—ã–µ, —É–¥–∞–ª–µ–Ω–Ω–∞—è —Ä–∞–±–æ—Ç–∞, —É–∏–∫–µ–Ω–¥ —É –∫–∞–º–∏–Ω–∞, –±–∞—Ä–±–µ–∫—é –Ω–∞ —Ç–µ—Ä—Ä–∞—Å–µ –∏ —Ç. –ø.) —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏.
–ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é: –¥–∞–π 2 –≤–∞—Ä–∏–∞–Ω—Ç–∞ CTA, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—è—Å—å –Ω–∞ –æ–Ω–ª–∞–π–Ω-–±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–ª–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä, –±–µ–∑ –Ω–∞–≤—è–∑—á–∏–≤—ã—Ö –æ–±–µ—â–∞–Ω–∏–π, —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º —à–∞–≥–æ–º (–Ω–∞–ø–∏—Å–∞—Ç—å, –∑–∞–±—Ä–æ–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–∞—Ç—ã, –Ω–∞–∑–Ω–∞—á–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä).

–ü—Ä–∞–≤–∏–ª–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏:
‚Äî –ï—Å–ª–∏ –∫–∞–∫–æ–µ-—Ç–æ –ø–æ–ª–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç, –Ω–µ –≤—ã–¥—É–º—ã–≤–∞–π; –¥–µ–ª–∏–∫–∞—Ç–Ω–æ –æ–ø—É—Å—Ç–∏ –µ–≥–æ –∏–ª–∏ –ø–æ–º–µ—Ç—å [–ø—Ä–µ–¥–ø–æ–ª–æ–∂–µ–Ω–∏–µ] (–Ω–µ –±–æ–ª–µ–µ –¥–≤—É—Ö –Ω–∞ –≤–µ—Å—å —Ç–µ–∫—Å—Ç).
‚Äî –ù–µ –ø–æ–≤—Ç–æ—Ä—è–π –æ–¥–Ω–∏ –∏ —Ç–µ –∂–µ —Ñ–∞–∫—Ç—ã –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–∞–∑–¥–µ–ª–∞—Ö –±–µ–∑ –¥–æ–±–∞–≤–ª–µ–Ω–Ω–æ–π —Ü–µ–Ω–Ω–æ—Å—Ç–∏.
‚Äî –¶–∏—Ñ—Ä—ã –≤–∞–∂–Ω–µ–µ –æ–±—â–∏—Ö —Å–ª–æ–≤; —É–∫–∞–∑—ã–≤–∞–π –∏–∑–º–µ—Ä–∏–º—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.
‚Äî –ù–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–π —ç—Ç–∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏, –Ω–µ –¥–æ–±–∞–≤–ª—è–π –¥–∏—Å–∫–ª–µ–π–º–µ—Ä—ã, –∏–∑–≤–∏–Ω–µ–Ω–∏—è –∏–ª–∏ –º–µ—Ç–∞–º–µ—Ç–∫–∏.
‚Äî –¢–µ–∫—Å—Ç –≤—ã–≤–µ–¥–∏ –æ–¥–Ω–∏–º –±–ª–æ–∫–æ–º, –±–µ–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ –≤–∏–¥–∞ ¬´–†–∞–∑–¥–µ–ª:¬ª –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ; –ø—Ä–æ—Å—Ç–æ —Å–ª–µ–¥—É–π –ø–æ—Ä—è–¥–∫—É –±–ª–æ–∫–æ–≤ –∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—é.

–î–ª–∏–Ω–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è: ~1000 —Å–∏–º–≤–æ–ª–æ–≤ (¬±10%), –≤–∫–ª—é—á–∞—è –ø—Ä–æ–±–µ–ª—ã.
–ü—Ä–∏—Å—ã–ª–∞–π —Ç–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ, –±–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤.
"""

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_LEVEL = logging.INFO

# ============================================================================
# –ö–û–ù–ï–¶ –ë–õ–û–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò
# ============================================================================


# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
logging.basicConfig(
    format='%(asctime)s - %(name)s - %(levelname)s - %(message)s',
    level=LOG_LEVEL
)
logger = logging.getLogger(__name__)


class TelegramBot:
    """–ö–ª–∞—Å—Å —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–∞ —Å LangChain"""
    
    def __init__(self):
        """–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞ –∏ LLM"""
        self.llm = ChatOpenAI(
            model=MODEL_NAME,
            temperature=TEMPERATURE,
            max_tokens=MAX_TOKENS,
            top_p=TOP_P,
            frequency_penalty=FREQUENCY_PENALTY,
            presence_penalty=PRESENCE_PENALTY,
            openai_api_key=OPENAI_API_KEY
        )
        self.last_keep_alive_message_id = None
        # –•—Ä–∞–Ω–∏–º ID –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞
        self.welcome_messages = {}
        logger.info(f"LLM –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω: {MODEL_NAME}")
    
    async def send_keep_alive_message(self, context: ContextTypes.DEFAULT_TYPE):
        """–û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ "–Ω–µ —Å–ø–∞—Ç—å" –∏ —É–¥–∞–ª—è–µ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–µ."""
        bot = context.bot
        
        try:
            # –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –µ—Å–ª–∏ –æ–Ω–æ –µ—Å—Ç—å
            if self.last_keep_alive_message_id:
                try:
                    await bot.delete_message(
                        chat_id=KEEP_ALIVE_CHAT_ID,
                        message_id=self.last_keep_alive_message_id
                    )
                    logger.info(f"–£–¥–∞–ª–µ–Ω–æ –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ keep-alive (ID: {self.last_keep_alive_message_id})")
                except Exception as e:
                    logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ keep-alive: {e}")
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
            message = await bot.send_message(
                chat_id=KEEP_ALIVE_CHAT_ID,
                text=KEEP_ALIVE_MESSAGE_TEXT
            )
            self.last_keep_alive_message_id = message.message_id
            logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ keep-alive (ID: {self.last_keep_alive_message_id}) –≤ —á–∞—Ç {KEEP_ALIVE_CHAT_ID}")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ/—É–¥–∞–ª–µ–Ω–∏–∏ keep-alive —Å–æ–æ–±—â–µ–Ω–∏—è: {e}", exc_info=True)

    async def delete_message_pair(self, context: ContextTypes.DEFAULT_TYPE):
        """–£–¥–∞–ª—è–µ—Ç –ø–∞—Ä—É —Å–æ–æ–±—â–µ–Ω–∏–π (–∑–∞–ø—Ä–æ—Å + –æ—Ç–≤–µ—Ç)"""
        job = context.job
        chat_id = job.data['chat_id']
        user_message_id = job.data['user_message_id']
        bot_message_id = job.data['bot_message_id']
        reply_template_message_id = job.data.get('reply_template_message_id') # –ú–æ–∂–µ—Ç –±—ã—Ç—å None
        
        try:
            # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            await context.bot.delete_message(chat_id=chat_id, message_id=user_message_id)
            logger.info(f"–£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_message_id}")
        except Exception as e:
            logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {user_message_id}: {e}")
        
        try:
            # –£–¥–∞–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞
            await context.bot.delete_message(chat_id=chat_id, message_id=bot_message_id)
            logger.info(f"–£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ {bot_message_id}")
        except Exception as e:
            logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ {bot_message_id}: {e}")

        if reply_template_message_id:
            try:
                await context.bot.delete_message(chat_id=chat_id, message_id=reply_template_message_id)
                logger.info(f"–£–¥–∞–ª–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ-reply –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ {reply_template_message_id}")
            except Exception as e:
                logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ-reply –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ {reply_template_message_id}: {e}")

    async def start(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /start"""
        chat_id = update.effective_chat.id
        
        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å HTML-—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º
        welcome_msg = await update.message.reply_text(
            WELCOME_MESSAGE,
            parse_mode='HTML'
        )
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º ID –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è —ç—Ç–æ–≥–æ —á–∞—Ç–∞
        self.welcome_messages[chat_id] = welcome_msg.message_id
        
        logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç {chat_id}, ID: {welcome_msg.message_id}")
    
    async def help_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /help"""
        await update.message.reply_text(
            "‚ÑπÔ∏è –ü—Ä–æ—Å—Ç–æ –æ—Ç–ø—Ä–∞–≤—å –º–Ω–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏, –∏ —è —Å–æ–∑–¥–∞–º –ø—Ä–æ–¥–∞—é—â–∏–π —Ç–µ–∫—Å—Ç.\n"
            "–°–æ–æ–±—â–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ 1 –º–∏–Ω—É—Ç—É."
        )
    
    async def settings_command(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"""
        settings_text = f"""
‚öôÔ∏è –¢–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

ü§ñ –ú–æ–¥–µ–ª—å: {MODEL_NAME}
üå° Temperature: {TEMPERATURE}
üìä Max Tokens: {MAX_TOKENS}
üéØ Top P: {TOP_P}
üîÅ Frequency Penalty: {FREQUENCY_PENALTY}
‚ú® Presence Penalty: {PRESENCE_PENALTY}
‚è± –í—Ä–µ–º—è –¥–æ —É–¥–∞–ª–µ–Ω–∏—è: {MESSAGE_DELETE_TIMEOUT} —Å–µ–∫

üí¨ –°–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç:
{SYSTEM_PROMPT[:200]}...
        """
        await update.message.reply_text(settings_text)
    
    async def handle_message(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π"""
        user_message = update.message.text
        user_id = update.effective_user.id
        chat_id = update.effective_chat.id
        user_message_id = update.message.message_id
        
        logger.info(f"–ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç {user_id}: {user_message[:50]}...")
        
        try:
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º, —á—Ç–æ –±–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç
            await update.message.chat.send_action(action="typing")
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è LLM
            messages = [
                HumanMessage(content=f"{SYSTEM_PROMPT}\n\n–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {user_message}")
            ]
            
            # –ü–æ–ª—É—á–∞–µ–º –æ—Ç–≤–µ—Ç –æ—Ç LLM
            response = await self.llm.ainvoke(messages)
            bot_response = response.content
            
            logger.info(f"–û—Ç–≤–µ—Ç –¥–ª—è {user_id}: {bot_response[:50]}...")
            
            # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ –∑–∞–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            bot_message = await update.message.reply_text(bot_response)
            bot_message_id = bot_message.message_id
            
            # –ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –Ω–µ–≥–æ reply
            reply_template_message_id = None
            if chat_id in self.welcome_messages:
                welcome_msg_id = self.welcome_messages[chat_id]
                try:
                    reply_template_message = await context.bot.send_message(
                        chat_id=chat_id,
                        text="‚úÖ –®–∞–±–ª–æ–Ω!",
                        reply_to_message_id=welcome_msg_id
                    )
                    reply_template_message_id = reply_template_message.message_id
                    logger.info(f"–û—Ç–ø—Ä–∞–≤–ª–µ–Ω reply –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ {welcome_msg_id}, ID: {reply_template_message_id}")
                except Exception as e:
                    logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å reply –Ω–∞ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: {e}")
            
            # –ü–ª–∞–Ω–∏—Ä—É–µ–º —É–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä—ã —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ MESSAGE_DELETE_TIMEOUT —Å–µ–∫—É–Ω–¥
            context.job_queue.run_once(
                self.delete_message_pair,
                when=MESSAGE_DELETE_TIMEOUT,
                data={
                    'chat_id': chat_id,
                    'user_message_id': user_message_id,
                    'bot_message_id': bot_message_id,
                    'reply_template_message_id': reply_template_message_id
                },
                name=f"delete_{chat_id}_{user_message_id}"
            )
            
            logger.info(f"–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ —É–¥–∞–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π {user_message_id}, {bot_message_id} –∏ {reply_template_message_id} —á–µ—Ä–µ–∑ {MESSAGE_DELETE_TIMEOUT} —Å–µ–∫")
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}", exc_info=True)
            await update.message.reply_text(
                "üòî –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –∑–∞–ø—Ä–æ—Å–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑."
            )
    
    async def error_handler(self, update: Update, context: ContextTypes.DEFAULT_TYPE):
        """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫"""
        logger.error(f"Update {update} caused error {context.error}", exc_info=context.error)


def main():
    """–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞"""
    logger.info("–ó–∞–ø—É—Å–∫ –±–æ—Ç–∞...")
    
    # –°–æ–∑–¥–∞–µ–º —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
    bot = TelegramBot()
    
    # –°–æ–∑–¥–∞–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
    application = ApplicationBuilder().token(TELEGRAM_TOKEN).build()
    
    # –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
    application.add_handler(CommandHandler("start", bot.start))
    application.add_handler(CommandHandler("help", bot.help_command))
    application.add_handler(CommandHandler("settings", bot.settings_command))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, bot.handle_message))
    application.add_error_handler(bot.error_handler)
    
    # –ü–ª–∞–Ω–∏—Ä—É–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É keep-alive —Å–æ–æ–±—â–µ–Ω–∏—è
    job_queue = application.job_queue
    
    if job_queue is not None:
        # –í—ã—á–∏—Å–ª—è–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å —É—á–µ—Ç–æ–º —Ä–∞–∑–±—Ä–æ—Å–∞
        first_interval = KEEP_ALIVE_INTERVAL_SECONDS + random.uniform(-KEEP_ALIVE_JITTER_SECONDS, KEEP_ALIVE_JITTER_SECONDS)
        
        job_queue.run_repeating(
            bot.send_keep_alive_message,
            interval=KEEP_ALIVE_INTERVAL_SECONDS,
            first=first_interval
        )
        logger.info(f"Keep-alive —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è –∫–∞–∂–¥—ã–µ {KEEP_ALIVE_INTERVAL_SECONDS} —Å–µ–∫—É–Ω–¥ (¬±{KEEP_ALIVE_JITTER_SECONDS}—Å) –≤ —á–∞—Ç {KEEP_ALIVE_CHAT_ID}")
    else:
        logger.warning("JobQueue –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω. Keep-alive —Ñ—É–Ω–∫—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞.")

    # –ó–∞–ø—É—Å–∫–∞–µ–º –±–æ—Ç–∞
    logger.info("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ!")
    application.run_polling(allowed_updates=Update.ALL_TYPES)


if __name__ == "__main__":
    main()